<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>
    <style>
      #hash {
        color: green;
      }
    </style>
  </head>
  <body>
    <h1>Welcome</h1>
    <p id="info"></p>
    <p id="hash"></p>
    <button
      onclick="window.open('/start', '_blank', 'popup,width=600,height=400')"
    >
      Sign-in
    </button>
    <script
      type="text/javascript"
      src="https://alcdn.msauth.net/browser/2.18.0/js/msal-browser.min.js"
    ></script>
    <script>
      window.msalInstance = new msal.PublicClientApplication({
        auth: {
          authority:
            "https://login.microsoftonline.com/846807e1-c939-4d39-b759-2992852937f4",
          clientId: "8ae30598-9693-43e5-a8fb-05ea677b3253",
        },
      });
      window.msalInstance.loginRedirect({
        redirectUri:
          window.location.protocol + "//" + window.location.host + "/end",
        onRedirectNavigate: (navigateUrl) => {
          window.navigationUrl = navigateUrl;
          document.querySelector(
            "#info"
          ).innerText = `redirect URL is:${navigateUrl}`;
          return false;
        },
      });
      setInterval(() => {
        if (window.popupHash) {
          document.querySelector(
            "#hash"
          ).innerText = `hash received: ${window.popupHash}`;
        }
      }, 250);
    </script>
  </body>
</html>
